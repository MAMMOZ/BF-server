<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bot Data</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
  <div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">Bot Data</h1>
    <p id="last-updated" class="text-sm text-gray-500">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠: ‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</p>
    <div class="overflow-x-auto">
      <table class="table-auto w-full bg-white rounded-lg shadow-md">
        <thead class="bg-gray-200">
          <tr>
            <th class="px-4 py-2">Status</th>
            <th class="px-4 py-2">Account</th>
            <th class="px-4 py-2">Type</th>
            <th class="px-4 py-2">Level</th>
            <th class="px-4 py-2">World</th>
            <th class="px-4 py-2">Updated At</th>
          </tr>
        </thead>
        <tbody id="data-table" class="text-center">
          <!-- Data will be populated here -->
        </tbody>
      </table>
    </div>
  </div>

  <script>
    const apiUrl = "http://localhost:3000/bot"; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö API ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API
    const fetchBotData = async () => {
      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        updateTable(data);
        updateTimestamp();
      } catch (error) {
        console.error("Error fetching data:", error);
      }
    };

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö "X ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß"
    const timeAgo = (timestamp) => {
      const now = new Date();
      const updatedTime = new Date(timestamp);
      const diffInMinutes = Math.floor((now - updatedTime) / 60000);

      if (diffInMinutes < 1) return "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà";
      if (diffInMinutes === 1) return "1 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß";
      return `${diffInMinutes} ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
    };

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¥‡πÇ‡∏°‡∏à‡∏¥‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ
    const getEmojiByLastUpdated = (timestamp) => {
      const now = new Date();
      const updatedTime = new Date(timestamp);
      const diffInMinutes = Math.floor((now - updatedTime) / 60000);

      return diffInMinutes <= 10 ? "üçè" : "üçé";
    };

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    const updateTable = (data) => {
      const tableBody = document.getElementById("data-table");
      tableBody.innerHTML = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤
      data.forEach((item) => {
        const row = `
          <tr class="border-t">
            <td class="px-4 py-2">${getEmojiByLastUpdated(item.updatedAt)}</td>
            <td class="px-4 py-2">${item.account}</td>
            <td class="px-4 py-2">${item.type}</td>
            <td class="px-4 py-2">${item.level}</td>
            <td class="px-4 py-2">${item.world}</td>
            <td class="px-4 py-2">${timeAgo(item.updatedAt)}</td>
          </tr>
        `;
        tableBody.innerHTML += row;
      });
    };

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠"
    const updateTimestamp = () => {
      const timestampElement = document.getElementById("last-updated");
      const now = new Date();
      timestampElement.textContent = `‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${timeAgo(now.toISOString())}`;
    };

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å ‡πÜ 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    fetchBotData();
    setInterval(fetchBotData, 10000);
  </script>
</body>
</html>
